define("brix/bisheng/loop",["underscore"],function(e){function t(e){return void 0===e?a:(a=!!e,void(a?o=setTimeout(n,i):clearTimeout(o)))}function n(e,t){clearTimeout(o);for(var r,l=0;l<c.length;l++)r=c[l],r&&(void 0===e||r.data===e)&&(void 0===t||r.tpl===t)&&r(l);a&&(o=setTimeout(n,i))}var o,r=~location.search.indexOf("bisheng.debug")&&{fix:function(e,t){t=t||32;for(var n=parseInt(t,10)-(""+e).length,o=0;n>o;o++)e+=" ";return e}},a=!1,i=50,c=[];c.__index=0,a&&(o=setTimeout(n,i));var l=function(){function o(t,n,o){var a=f++,u=l(t,o,[a]),d=function(e){r&&console.group("task "+e),r&&console.time(r.fix("diff"));var i=s(t,u,o?[a]:[],o);r&&console.timeEnd(r.fix("diff")),i&&i.length&&(n(i,t,u),r&&console.time(r.fix("clone shadow")),u=l(t,o,[a]),r&&console.timeEnd(r.fix("clone shadow"))),r&&console.groupEnd("task "+e)};return d=e.throttle(d,i),d.data=t,d.callback=n,n&&n.tpl&&(d.tpl=n.tpl),c.push(d),u}function a(e,t){function n(e){for(var t=0;t<c.length;t++)e(c[t])&&(t<c.__index&&c.__index--,c.splice(t--,1))}e&&"function"==typeof t&&n(function(n){return n.callback===t&&n.data===e}),("function"==typeof e||!e&&"function"==typeof t)&&(t=e||t,n(function(e){return e.callback===t||e.callback.guid&&e.callback.guid===t.guid})),void 0!==e&&n(function(t){return t.data===e})}function l(e,t,n){var o,r,a=e.constructor();if(n=n||[],null===e||"object"!=typeof e)return e;t&&(a.$path=n.join("."));for(o in e)r=e[o],void 0!==r&&null!==r&&(r.constructor===Object||r.constructor===Array?r=l(r,t,n.concat(o)):t&&(r=new Object(r),r.$path=n.concat(o).join("."))),a[o]=r;return a}function s(e,t,n,o){function r(e,t){return function(){for(var n=e,o=1;o<t.length-1;o++)n=n[t[o]];return n}}var a=a||[];if(n=n||[],("object"!=typeof e||"object"!=typeof t)&&a.length)return a;if(u(e,t,n,a),d(e,t,n,a),p(e,t,n,a),o)for(var i,c=0;c<a.length;c++)i=a[c],i.root=e,i.context=r(e,i.path)(),i.getContext=r,i.shadow=t;return a.length?a:void 0}function u(e,t,n,o,r){var a,i;for(a in e)/\$guid|\$path|\$blocks|\$helpers/.test(a)||(i=e[a],a in t?void 0!==i&&null!==i&&void 0!==t[a]&&null!==t[a]&&i.constructor===t[a].constructor&&(i.constructor===Object||i.constructor===Array)&&u(i,t[a],n.concat(a),o,r):o.push(r?{type:r,path:n.concat(a),value:void 0,oldValue:e[a]}:{type:h.ADD,path:n.concat(a),value:e[a]}));return o.length?o:void 0}function d(e,t,n,o){return u(t,e,n,o,h.DELETE)}function p(e,t,n,o){var r,a;for(r in e)/\$guid|\$path|\$blocks|\$helpers/.test(r)||(a=e[r],r in t&&(void 0!==a||void 0!==t[r])&&!(void 0===a&&null===t[r]||null===a&&null===t[r]||null===a&&void 0===t[r]||!(void 0!==a&&null!==a&&void 0!==t[r]&&null!==t[r]&&a.constructor===t[r].constructor?a.constructor!==Object&&a.constructor!==Array?a.valueOf()!==t[r].valueOf()&&o.push({type:h.UPDATE,path:n.concat(r),value:a,oldValue:t[r]}):p(a,t[r],n.concat(r),o):o.push({type:h.UPDATE,path:n.concat(r),value:a,oldValue:void 0!==t[r]&&null!==t[r]?t[r].valueOf():t[r]}))));return o.length?o:void 0}var f=1,h={ADD:"add",DELETE:"delete",UPDATE:"update"};return{auto:t,tasks:c,TYPES:h,watch:o,unwatch:a,clone:l,diff:s,letMeSee:n}}();return l}),define("brix/bisheng/locator",["jquery","handlebars"],function(e,t){window.JSON||(window.JSON={stringify:function(e){var t,n=[];for(var o in e)t="string"==typeof e[o]?'"'+e[o]+'"':e[o],n.push('"'+o+'":'+t);return"{"+n.join(",")+"}"}});var n={create:function(e){var n=t.Utils.escapeExpression,o=n("<script");for(var r in e)void 0!==e[r]&&(o+=" "+r+n('="')+e[r]+n('"'));return o+=n("></script>")},getLocatorRegExp:function(){return/(<script(?:.*?)><\/script>)/gi},find:function(t,n){var o="script";for(var r in t)o+="["+r+'="'+t[r]+'"]';return e(o,n)},parse:function(t,n){var o=e(t).attr(n);return"ishelper"===n&&("true"===o&&(o=!0),"false"===o&&(o=!1)),o},update:function(t,n,o){if("script"===t.nodeName.toLowerCase()&&t.getAttribute("guid")&&"start"===t.getAttribute("slot")&&(o||!t.getAttribute("type")))for(var r in n)e(t).attr(r,n[r]);return t},parseTarget:function(t){for(var n,o=e(t).attr("guid"),r=[],a=t;a=a.nextSibling;)if(n=e(a),"script"===a.nodeName.toLowerCase()&&n.attr("guid")){if(n.attr("guid")===o&&"end"===n.attr("slot"))break}else r.push(a);return e(r)},between:function(t){for(var n,o=e(t).attr("guid"),r=[],a=t;a=a.nextSibling;)if(n=e(a),"script"===a.nodeName.toLowerCase()&&n.attr("guid")){if(n.attr("guid")===o&&"end"===n.attr("slot"))break;r.push(a)}else r.push(a);return e(r)}},o={create:function(e){var n=t.Utils.escapeExpression;return n("<!-- ")+n(JSON.stringify(e))+n(" -->")},getLocatorRegExp:function(){return/(<!--\s*({(?:.*?)})\s*-->)/gi},find:function(t,n){return e(n).add("*",n).contents().filter(function(){return 8===this.nodeType}).filter(function(e,n){try{var o=new Function("return "+n.nodeValue)();for(var r in t)if(t[r]!==o[r])return!1;return!0}catch(a){return!1}})},parse:function(e,t){var n=new Function("return "+e.nodeValue)();return t?n[t]:n},update:function(e,t,n){if(8===e.nodeType){var o=this.parse(e);if(o.guid&&"start"===o.slot&&(n||!o.type)){for(var r in t)o[r]=t[r];e.nodeValue=" "+JSON.stringify(o)+" "}}return e},parseTarget:function(t){for(var n=this.parse(t),o=[],r=t;r=r.nextSibling;)if(8===r.nodeType){var a=this.parse(r);if(a.guid===n.guid&&"end"===a.slot)break}else o.push(r);return e(o)},between:function(t){for(var n=this.parse(t),o=[],r=t;r=r.nextSibling;)if(8===r.nodeType){var a=this.parse(r);if(a.guid===n.guid&&"end"===a.slot)break;o.push(r)}else o.push(r);return e(o)}};return n.ScriptLocator=n,n.JsonCommentLocator=o,o.ScriptLocator=n,o.JsonCommentLocator=o,-1!==location.search.indexOf("locator=script")?n:-1!==location.search.indexOf("locator=comment")?o:n}),define("brix/bisheng/ast",["underscore","handlebars","./locator"],function(e,t,n){var o=1,r=t.helpers["if"];t.registerHelper("if",function(e,t){return r.call(this,void 0!==e&&null!==e?e.valueOf():e,t)});var a=t.helpers.blockHelperMissing;return t.registerHelper("blockHelperMissing",function(e,t){return a.call(this,void 0!==e&&null!==e?e.valueOf():e,t)}),t.registerHelper("$lastest",function(e){return e&&e.$path||this&&this.$path}),{handle:function(e,t,n,o,r){return 2===arguments.length&&(o=t,t=void 0,r={}),3===arguments.length&&(o=t,r=n,t=n=void 0),this[e.type]&&this[e.type](e,t,n,o,r),e},program:function(e,t,n,o,r){for(var a=0;a<e.statements.length;a++)this.handle(e.statements[a],e.statements,a,o,r)},mustache:function(r,a,i,c,l){if(!r.binded){var s=[];r.isHelper?e.each(r.params,function(e){"ID"===e.type&&s.push(e.string)}):s.push(r.id.string),s=s.join(" ");var u,d,p={guid:o,slot:"",type:"text",path:"{{$lastest "+s+"}}",ishelper:!!r.isHelper,isscoped:function(){return r.isHelper?!1:r.id.isScoped}()};p.slot="start",u=n.create(p),d=t.parse(u).statements,d[1].binded=!0,a.splice.apply(a,[i,0].concat(d)),u=n.create({guid:p.guid,slot:"end",type:"todo"}),d=t.parse(u).statements,a.splice.apply(a,[i+4,0].concat(d)),l&&(l[o]={constructor:t.AST.ProgramNode,type:"program",statements:[r]}),o++,r.binded=!0}},block:function(e,r,a,i,c){if(!e.binded){var l,s;0===e.mustache.params.length?(l="",s=e.mustache.id.string):(l=e.mustache.id.string,s=e.mustache.params[0].string);var u,d,p={guid:o,slot:"",type:"block",path:"{{$lastest "+s+"}}",helper:l,isscoped:function(){return 0===e.mustache.params.length?!1:e.mustache.params[0].isScoped}()};p.slot="start",u=n.create(p),d=t.parse(u).statements,d[1].binded=!0,r.splice.apply(r,[a,0].concat(d)),u=n.create({guid:p.guid,slot:"end",type:"todo"}),d=t.parse(u).statements,r.splice.apply(r,[a+4,0].concat(d)),i&&(i[o]={constructor:t.AST.ProgramNode,type:"program",statements:[e]}),o++,e.binded=!0,this.handle(e.program||e.inverse,r,a,i,c)}}}}),define("brix/bisheng/scan",["jquery","underscore","./loop","./locator"],function(e,t,n,o){function r(e,t,n){a(e),s(e,t,n)}function a(e){switch(e.nodeType){case 1:case 9:case 11:c(e),l(e);break;case 3:i(e)}}function i(n){var r=o.getLocatorRegExp(),a=n.textContent||n.innerText||n.nodeValue;if(a.length&&e.trim(a).length&&r.test(a)){var i=e("<div>"+a+"</div>").contents();t.each(i,function(e){o.update(e,{type:"text"})}),i.replaceAll(n)}}function c(n){var r=o.getLocatorRegExp(),a=/([^;]*?): ([^;]*)/gi,i=function(){for(var e=[],t=n.attributes,o=0;o<t.length;o++)(t[o].specified||t[o].nodeValue)&&e.push(t[o]);return e}();i.length&&t.each(i,function(i){var c,l,s,u=i.nodeName,d=i.value,f=[];if(u=u.toLowerCase(),s=p[u],u=s?s.name:u,"style"===u)for(a.exec("");l=a.exec(d);)for(r.exec("");c=r.exec(l[2]);)f.push(o.update(e("<div>"+c[1]+"</div>").contents()[0],{type:"attribute",name:u,css:e.trim(l[1])},!0));else for(r.exec("");c=r.exec(d);)f.push(o.update(e("<div>"+decodeURIComponent(c[1])+"</div>").contents()[0],{type:"attribute",name:u},!0));f.length&&(d=d.replace(r,""),i.value=d,t.each(f,function(t){var r=o.parse(t,"slot");"start"===r&&e(n).before(t),"end"===r&&e(n).after(t)})),s&&s.teardown(n,d)})}function l(e){for(var n=[],o=0,r=e.childNodes,i=r.length;i>o;o++)n.push(r[o]);t.each(n,function(e){a(e)})}function s(r,a){var i=o.find({slot:"start",type:"attribute",name:"value"},r);t.each(i,function(t){var r=o.parse(t,"path").split("."),i=o.parseTarget(t)[0];e(i).on("change.bisheng keyup.bisheng",function(e){if("keyup"===e.type){var t=e.keyCode;if(91===t||t>15&&19>t||t>=37&&40>=t)return}u(a,r,e.target),n.auto()||n.letMeSee(a)})}),t.each(o.find({slot:"start",type:"attribute",name:"checked"},r),function(t){for(var r=o.parse(t,"path").split("."),i=o.parseTarget(t)[0],c=a,l=1;l<r.length;l++)c=c[r[l]];(void 0===c||c.valueOf()===!1||"false"===c.valueOf())&&e(i).prop("checked",!1),void 0===c||c.valueOf()!==!0&&"true"!==c.valueOf()&&"checked"!==c.valueOf()||e(i).prop("checked",!0),e(i).on("change.bisheng",function(t,o){o||"radio"!==t.target.type||e('input:radio[name="'+t.target.name+'"]').not(t.target).trigger("change.bisheng",o=!0),d(a,r,t.target),n.auto()||n.letMeSee(a)})}),t.each(o.find({slot:"start",type:"attribute",name:"disabled"},r),function(t){for(var n=o.parse(t,"path").split("."),r=o.parseTarget(t)[0],i=a,c=1;c<n.length;c++)i=i[n[c]];(void 0===i||i.valueOf()===!1||"false"===i.valueOf())&&e(r).prop("disabled",!1),void 0===i||i.valueOf()!==!0&&"true"!==i.valueOf()&&"disabled"!==i.valueOf()||e(r).prop("disabled",!0)})}function u(t,n,o){for(var r=1;r<n.length-1;r++)t=t[n[r]];var a=f[o.type]||f[o.nodeName.toLowerCase()]||f._default,i=a(e(o));i!==!1&&(t[n[n.length-1]]=i)}function d(t,n,o){for(var r=1;r<n.length-1;r++)t=t[n[r]];var a=h[o.type]||h[o.nodeName.toLowerCase()]||h._default,i=a(e(o),t);void 0!==i&&(t[n[n.length-1]]=i)}var p={"bs-style":{name:"style",setup:function(){},teardown:function(t,n){e(t).attr("style",n)}},"bs-src":{name:"src",setup:function(){},teardown:function(t,n){e(t).attr("src",n)}},"bs-disabled":{name:"disabled",setup:function(){},teardown:function(t,n){"false"===n||"disabled"===n?e(t).attr("disabled","disabled").prop("disabled",!0):e(t).attr("disabled",!1).prop("disabled",!1)}},"bs-checked":{name:"checked",setup:function(){},teardown:function(t,n){("true"===n||"checked"===n)&&e(t).attr("checked","checked").prop("checked",!0)}}},f={text:function(e){return e.data("user is editing",!0),e.val()},radio:function(){return!1},checkbox:function(){return!1},_default:function(e){return e.val()}},h={radio:function(e,t){var n=e.attr("name"),o=e.prop("checked");return n&&o&&n in t&&(t[n]=e.val()),o},checkbox:function(e){return e.prop("checked")},_default:function(){}};return{scan:r}}),define("brix/bisheng/html",["jquery"],function(e){var t={},n=/<([\w:]+)/,o={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[1,"<div>","</div>"]};return o.optgroup=o.option,o.tbody=o.tfoot=o.colgroup=o.caption=o.thead,o.th=o.td,t.wrap=function(){},t.convert=function(t){var r=(n.exec(t)||["",""])[1].toLowerCase(),a=o[r]||o._default,i=a[0],c=document.createElement("div");for(c.innerHTML=a[1]+t+a[2];i--;)c=c.lastChild;return e(c)},t.table=function(e){return e.replace(/(<table.*?>)([\w\W]*?)(<\/table>)/g,function(e){return e.replace(/(>)([\w\W]*?)(<)/g,function(e,n,o,r){if(o.indexOf("&lt;")>-1){var a="";return t.convert(o).contents().each(function(e,t){a+=t.nodeValue}),n+a+r}return n+o+r})})},t}),define("brix/bisheng/flush",["jquery","underscore","handlebars","./loop","./scan","./html","./locator"],function(e,t,n,o,r,a,i){function c(e,n,o,r,a){var l=i.find({slot:"start",path:n.path.join(".")},r||document.body);if(("delete"===n.type||"add"===n.type)&&n.context instanceof Array)return n.path.pop(),n.type="update",n.value=n.context,n.context=n.getContext(n.root,n.path)(),void c(e,n,o,r,a);if(0===l.length){return}var s,u;t.each(l,function(t){s=i.parse(t,"type"),u=i.parse(t,"guid");var r;f&&(r=f.fix(u,4)+f.fix(s,16)+f.fix(n.path.join("."),32)),f&&console.group(r),f&&console.time(f.fix("Flush.handle["+s+"]")),c[s]&&c[s](t,e,n,o,a),f&&console.timeEnd(f.fix("Flush.handle["+s+"]")),f&&console.groupEnd(r)})}function l(e){e.target.nodeType&&(e.target=[e.target]),e.target.forEach&&e.target.forEach(function(e){switch(e.nodeType){case 3:e.parentNode.scrollIntoView();break;case 1:e.scrollIntoView()}})}function s(t){t.target.nodeType&&(t.target=[t.target]),t.target.forEach&&t.target.forEach(function(t){switch(t.nodeType){case 3:e(t).wrap("<span>").parent().addClass("transition highlight"),setTimeout(function(){e(t).unwrap("<span>").removeClass("transition highlight")},500);break;case 1:e(t).addClass("transition highlight"),setTimeout(function(){e(t).removeClass("transition highlight")},500)}})}function u(e,t,n){p("before",e,t,n)}function d(e,t,n){p("after",e,t,n)}function p(e,n,o,r){n&&n[e]&&n[e](t.map(r,function(e){return{type:o.join("_"),target:e}}))}var f=~location.search.indexOf("bisheng.debug")&&{fix:function(e,t){t=t||32;for(var n=parseInt(t,10)-(""+e).length,o=0;n>o;o++)e+=" ";return e}};return c.text=function(t,o,r,c,l){var s,p=i.parse(t,"guid"),f=i.parse(t,"ishelper"),h=i.parseTarget(t);s="true"===f||f===!0?n.compile(c.$helpers[p])(r.context):r.value,1===h.length&&3===h[0].nodeType?(o.target.push(h[0]),u(l,["update","text"],[h[0]]),h[0].nodeValue=s,d(l,["update","text"],[h[0]])):(s="true"===f||f===!0?n.compile(c.$helpers[p])(r.context):r.value,u(l,["delete","block"],h),e(h).remove(),d(l,["delete","block"],h),u(l,["add","block"],s),s=a.convert(s).contents().insertAfter(t).each(function(e,t){o.target.push(t)}),d(l,["add","block"],s))},c.attribute=function(t,r,a,c,l){var s,p,f,h=i.parse(t,"guid"),g=i.parse(t,"ishelper");r.target.push(s=i.parseTarget(t)[0]),f=e(s),u(l,["update","attribute"],f);var v,b;if("true"===g||g===!0)v=n.compile(c.$helpers[h])(a.context),b=function(){var e,t=o.clone(a.context,!0,a.path.slice(0,-1));return t[a.path[a.path.length-1]]=void 0!==a.oldValue&&null!==a.oldValue?a.oldValue.valueOf():a.oldValue,e=n.compile(c.$helpers[h])(t)}();else{var m=c.$blocks[i.parse(t,"guid")];v=m?n.compile(m)(a.context):a.value,b=function(){var e,t=o.clone(a.context,!0,a.path.slice(0,-1));return t[a.path[a.path.length-1]]=void 0!==a.oldValue&&null!==a.oldValue?a.oldValue.valueOf():a.oldValue,e=m?n.compile(m)(t):a.oldValue}()}switch(p=i.parse(t,"name")){case"class":f.removeClass(""+b).addClass(""+v);break;case"bs-style":case"style":f.css(i.parse(t,"css"),v);break;case"value":f.val()===v||f.data("user is editing")||f.val(v),f.data("user is editing",!1);break;case"disabled":f.prop(p,v);break;case"checked":f.prop(p,v),p=f.attr("name"),p&&f.prop("checked")&&p in a.context&&(a.context[p]=f.val());break;default:f.attr(p,function(e,t){return void 0===b?v:t!==b.valueOf()?t.replace(b,v):v})}d(l,["update","attribute"],f)},c.block=function(t,c,l,s,p){var h=i.parse(t,"guid"),g=i.parse(t,"isscoped"),v=s.$blocks[h];f&&console.time(f.fix("Loop.clone"));var b=o.clone(l.context,!0,l.path.slice(0,-1));f&&console.timeEnd(f.fix("Loop.clone"));var m=n.compile(v)("true"===g||g===!0?l.value:b);f&&console.time(f.fix("HTML.convert")),m=a.convert(m),f&&console.timeEnd(f.fix("HTML.convert")),f&&console.time(f.fix("Scanner.scan")),r.scan(m[0],l.root),f&&console.timeEnd(f.fix("Scanner.scan")),m=m.contents();var x=i.between(t),y=i.find({guid:h,slot:"end"},t.parentNode)[0];if(0===m.length)return u(p,["delete","block"],x),e(x).remove(),void d(p,["delete","block"],x);if(m.length<x.length){var k=e(x.splice(m.length,x.length-m.length));u(p,["delete","block"],k),k.remove(),d(p,["delete","block"],k)}m.each(function(e,t){return x[e]?t.nodeType!==x[e].nodeType?(u(p,["add","block"],[t]),x[e].parentNode.insertBefore(t,x[e]),d(p,["add","block"],[t]),u(p,["delete","block"],[x[e]]),x[e].parentNode&&x[e].parentNode.removeChild(x[e]),d(p,["delete","block"],[x[e]]),void c.target.push(t)):3===t.nodeType&&t.nodeValue!==x[e].nodeValue?(u(p,["update","text"],[x[e]]),x[e].nodeValue=t.nodeValue,void d(p,["update","text"],[x[e]])):8===t.nodeType&&t.nodeValue!==x[e].nodeValue?(u(p,["update","text"],[x[e]]),x[e].nodeValue=t.nodeValue,void d(p,["update","text"],[x[e]])):1===t.nodeType&&t.outerHTML!==x[e].outerHTML?(u(p,["add","block"],[t]),x[e].parentNode.insertBefore(t,x[e]),d(p,["add","block"],[t]),u(p,["delete","block"],[x[e]]),x[e].parentNode&&x[e].parentNode.removeChild(x[e]),d(p,["delete","block"],[x[e]]),void c.target.push(t)):void 0:(u(p,["add","block"],[t]),y.parentNode.insertBefore(t,y),d(p,["add","block"],[t]),void c.target.push(t))})},{handle:c,scrollIntoView:l,highlight:s}}),define("brix/bisheng",["jquery","underscore","handlebars","./bisheng/loop","./bisheng/locator","./bisheng/ast","./bisheng/scan","./bisheng/flush","./bisheng/html"],function(e,t,n,o,r,a,i,c,l){function s(e){return arguments.length?(o.auto(e),this):o.auto()}function u(r,s,u,p){function f(e){t.each(e,function(e,t){var n,o={target:[]};v&&(n=v.fix("Flush.handle changes["+t+"] "+e.path.join("."))),v&&console.time(n),v&&console.group(n),c.handle(o,e,h,p,u),v&&console.groupEnd(n),v&&console.timeEnd(n),v&&console.log(">",e.path.join(".")),location.href.indexOf("scrollIntoView")>-1&&c.scrollIntoView(o,r),location.href.indexOf("highlight")>-1&&c.highlight(o,r)})}v&&(console.group("bind"),console.time("bind")),"function"==typeof u&&(u={resolve:u}),3===arguments.length&&(u.nodeType||u.length)&&(p=u,u={resolve:function(t){e(p).append(t)}}),u||(u={}),f.tpl=s,v&&console.time(v.fix("clone"));var h=o.watch(r,f,!0,!0);v&&console.timeEnd(v.fix("clone"));var g=s;s=s.replace(/(<.*?)(style)(=.*?>)/g,"$1bs-style$3").replace(/(<input.*?)(checked)(=.*?>)/g,"$1bs-checked$3").replace(/(<input.*?)(disabled)(=.*?>)/g,"$1bs-disabled$3").replace(/(<img.*?)(src)(=.*?>)/g,"$1bs-src$3"),v&&console.time(v.fix("ast"));var b=n.parse(s);a.handle(b,void 0,void 0,h.$blocks={},h.$helpers={}),v&&console.timeEnd(v.fix("ast")),v&&console.time(v.fix("compile"));var m=n.compile(b);v&&console.timeEnd(v.fix("compile")),v&&console.time(v.fix("render"));var x=m(h);v&&console.timeEnd(v.fix("render")),v&&console.time(v.fix("table")),x=l.table(x),v&&console.timeEnd(v.fix("table")),v&&console.time(v.fix("convert"));var y=e(l.convert(x));return v&&console.timeEnd(v.fix("convert")),v&&console.time(v.fix("scan")),y.length&&i.scan(y[0],r,g),v&&console.timeEnd(v.fix("scan")),y=y.contents().get(),u.resolve&&u.resolve.call(r,y),v&&(console.timeEnd("bind"),console.groupEnd("bind")),{data:r,tpl:g,unbind:function(){return d(this.data,this.tpl),this},apply:function(e){e&&e(this.data);var t="applying";return v&&(console.group(t),console.time(t)),o.letMeSee(this.data,this.tpl),v&&(console.timeEnd(t),console.groupEnd(t)),this}}}function d(e,t){if(t)for(var n,r=0;r<o.tasks.length;r++)n=o.tasks[r],n.data===e&&n.tpl===t&&o.tasks.splice(r--,1);else o.unwatch(e);return this}function p(e,t,n){function r(e){for(var t=e.length;t>0;t--)if(l[e.slice(0,t).join(".")])return!0}function a(t){for(var o=0;o<t.length;o++)c=t[o],r(c.path)&&n.call(e,c)}var i,c,l={};if(t&&3===arguments.length){for(t=t.constructor!==Array?[t]:t,i=0;i<t.length;i++)l[t[i]]=!0;n.guid=n.guid||g++,a.guid=n.guid,a.properties=t,o.watch(e,a)}else n=t||n,n.guid=n.guid||g++,o.watch(e,n);return this}function f(e,t,n){if(!e)return this;if(1===arguments.length&&"function"==typeof e&&(n=e,e=t=void 0),2===arguments.length&&"function"==typeof t&&(n=t,t=void 0),!t)return o.unwatch(e,n),this;var r,a,i,c,l=!1,s=[];for(s=t.constructor!==Array?[t]:t,r=0;r<o.tasks.length;r++)if(c=o.tasks[r],l=!1,c.data===e&&c.callback.properties&&(!n||c.callback.guid===n.guid)){for(a=0;a<s.length;a++)for(i=0;i<c.callback.properties.length;i++)c.callback.properties[i]===s[a]&&(c.callback.properties.splice(i--,1),c.callback.properties.length||(l=!0));l&&o.tasks.splice(r--,1)}return this}function h(e){return e&&e(),o.letMeSee(),v&&console.log("applying ..."),this}var g=1,v=~location.search.indexOf("bisheng.debug")&&{fix:function(e,t){t=t||32;for(var n=parseInt(t,10)-(""+e).length,o=0;n>o;o++)e+=" ";return e}};return{version:"0.1.1",Loop:o,Locator:r,AST:a,Scanner:i,Flush:c,auto:s,bind:u,unbind:d,watch:p,unwatch:f,apply:h}});
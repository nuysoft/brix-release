!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery"),require("underscore"),require("components/base"),require("brix/event")):"function"==typeof define&&define.amd?define(["jquery","underscore","components/base","brix/event"],e):"object"==typeof exports?exports["components/colorpicker"]=e(require("jquery"),require("underscore"),require("components/base"),require("brix/event")):t["components/colorpicker"]=e(t.jquery,t.underscore,t["components/base"],t["brix/event"])}(this,function(t,e,o,i){return function(t){function e(i){if(o[i])return o[i].exports;var s=o[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){var i,s;i=[o(2),o(3),o(4),o(5),o(6)],s=function(t,e,o,i,s,r,c,n,l){function a(){}function d(t,e,o){var i,s,r,c,n;t=t%360/60,n=o*e,c=n*(1-Math.abs(t%2-1)),i=s=r=o-n,t=~~t,i+=[n,c,0,0,c,n][t],s+=[c,n,n,c,0,0][t],r+=[0,0,c,n,n,c][t];var l=255*i,a=255*s,d=255*r;return{r:l,g:a,b:d,hex:"#"+(16777216|d|a<<8|l<<16).toString(16).slice(1)}}function p(t,e,o){(t>1||e>1||o>1)&&(t/=255,e/=255,o/=255);var i,s,r,c;return r=Math.max(t,e,o),c=r-Math.min(t,e,o),i=0===c?null:r==t?(e-o)/c+(e<o?6:0):r==e?(o-t)/c+2:(t-e)/c+4,i=i%6*60,s=0===c?0:c/r,{h:i,s:s,v:r}}return r='\t            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\t                <defs>\t                    <linearGradient id="gradient-hsv" x1="0%" y1="100%" x2="0%" y2="0%">\t                        <stop offset="0%" stop-color="#FF0000" stop-opacity="1"></stop>\t                        <stop offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop>\t                        <stop offset="25%" stop-color="#8000FF" stop-opacity="1"></stop>\t                        <stop offset="38%" stop-color="#0040FF" stop-opacity="1"></stop>\t                        <stop offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop>\t                        <stop offset="63%" stop-color="#00FF40" stop-opacity="1"></stop>\t                        <stop offset="75%" stop-color="#0BED00" stop-opacity="1"></stop>\t                        <stop offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#FF0000" stop-opacity="1"></stop>\t                    </linearGradient>\t                </defs>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-hsv)"></rect>\t            </svg>\t        ',c='\t            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\t                <defs>\t                    <lineargradient id="gradient-black" x1="0%" y1="100%" x2="0%" y2="0%">\t                        <stop offset="0%" stop-color="#000000" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\t                    </lineargradient>\t                    <lineargradient id="gradient-white" x1="0%" y1="100%" x2="100%" y2="100%">\t                        <stop offset="0%" stop-color="#FFFFFF" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\t                    </lineargradient>\t                </defs>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-white)"></rect>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-black)"></rect>\t            </svg>\t        ',n='\t            <div style="position: relative; width: 100%; height: 100%">\t                <v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>\t                </v:rect>\t            </div>\t        ',l='\t            <div style="position: relative; width: 100%; height: 100%">\t                <v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>\t                </v:rect>\t                <v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>\t                </v:rect>\t            </div>\t        ',e.extend(a.prototype,o.prototype,{options:{color:"#ffffff"},init:function(){},render:function(){var o=this,a=this.$element=t(this.element);this.color=this.options.color;var d=e.template(s)({colors:["#d81e06","#f4ea2a","#1afa29","#1296db","#13227a","#d4237a","#ffffff","#e6e6e6","#dbdbdb","#cdcdcd","#bfbfbf","#8a8a8a","#707070","#515151","#2c2c2c","#000000","#ea986c","#eeb174","#f3ca7e","#f9f28b","#c8db8c","#aad08f","#87c38f","#83c6c2","#7dc5eb","#87a7d6","#8992c8","#a686ba","#bd8cbb","#be8dbd","#e89abe","#e8989a","#e16632","#e98f36","#efb336","#f6ef37","#afcd51","#7cba59","#36ab60","#1baba8","#17ace3","#3f81c1","#4f68b0","#594d9c","#82529d","#a4579d","#db649b","#dd6572","#d81e06","#e0620d","#ea9518","#f4ea2a","#8cbb1a","#2ba515","#0e932e","#0c9890","#1295db","#0061b2","#0061b0","#004198","#122179","#88147f","#d3227b","#d6204b"],min:!1,color:this.color}),p=a.offset(),f=this.$relatedElement=t(d).css({left:p.left,top:p.top+a.outerHeight()+1}).insertAfter(a).hide();this.pickerDragNode=f.find(".picker-indicator"),this.slideDragNode=f.find(".slide-indicator");var h=this.$slideNode=f.find(".slide"),u=this.$pickerNode=f.find(".picker"),v=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";switch(v){case"SVG":h.append(r),u.append(c);break;default:document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),h.html(n),u.html(l)}this.setHex(this.color);var g=this.$manager=new i("bx-");g.delegate(this.$element,this),g.delegate(this.$relatedElement,this);var b="click.colorpicker_"+this.clientId;t(document.body).off(b).on(b,function(t){o.element!==t.target&&(f.has(t.target).length||o.hide())})},show:function(){this.$relatedElement.show()},hide:function(){this.$relatedElement.hide()},toggle:function(){var t=this.$element,e=t.offset();this.$relatedElement.toggle().offset({left:e.left,top:e.top+t.outerHeight()+1})},setColor:function(t){var e=this.$relatedElement;this.h=t.h%360,this.s=t.s,this.v=t.v;var o=d(this.h,this.s,this.v);this.slideDragNode.css({top:Math.round(this.h*this.$slideNode.height()/360-5)});var i=Math.round(this.s*this.$pickerNode.width()-5),s=Math.round((1-this.v)*this.$pickerNode.height()-5);this.pickerDragNode.css({left:i,top:s,color:s>98?"#fff":"#000"}),this.$pickerNode.css({"background-color":d(this.h,1,1).hex}),e.find(".colorpicker-footer span").css({"background-color":o.hex}),this.color=o.hex,e.find("li").removeClass("selected");var r=e.find("input");r.val()!==o.hex&&r.val(o.hex)},setHsv:function(t){this.setColor(t)},setRgb:function(t){this.setColor(p(t.r,t.g,t.b),t)},setHex:function(t){this.setColor(p(parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)),void 0,t)},pickQuickColor:function(e,o){this.setHex(o),t(e.target).addClass("selected")},toggleBody:function(){this.$relatedElement.find(".colorpicker-middle").toggleClass("open"),this.$relatedElement.find(".colorpicker-body").slideToggle()},pickPaletteColor:function(t){var e=this.$pickerNode.offset(),o=t.pageX-e.left,i=t.pageY-e.top,s=this.$pickerNode.width(),r=this.$pickerNode.height();this.setHsv({h:this.h,s:o/s,v:(r-i)/r})},dragPickerIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.pickerDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.$pickerNode.offset(),i=o.$pickerNode.width(),s=o.$pickerNode.height(),r=t.pageX-e.left,c=t.pageY-e.top;r+5>i?r=i:r<0?r=0:r+=5,c+5>s?c=s:c<0?c=0:c+=5,o.setHsv({h:o.h,s:r/i,v:(s-c)/s})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.pickerDragNode")})},pickSlideColor:function(t){var e=this.$slideNode.offset(),o=this.$slideNode.height(),i=t.pageY-e.top>=o?o-1:t.pageY-e.top,s=i/o*360;this.setHsv({h:s,s:this.s,v:this.v})},dragSlideIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.slideDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.$slideNode.offset(),i=o.$slideNode.height(),s=t.pageY-e.top;s+5>i?s=i-1:s<0?s=0:s+=5,o.setHsv({h:s/o.$slideNode.height()*360,s:o.s,v:o.v})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.slideDragNode")})},inputColor:function(e){var o=t(e.target).val();7===o.length&&this.color!==o&&this.setHex(o)},finishInputColor:function(e){var o=t(e.target).val();this.color!=o&&this.setHex(o)},submit:function(){var t=d(this.h,this.s,this.v),e={hex:t.hex,hsv:{h:this.h,s:this.s,v:this.v},rgb:{r:t.r,g:t.g,b:t.b}};this.trigger("change.colorpicker",e),this.$element.triggerHandler("change"),this.hide()},destroy:function(){this.$manager.undelegate(this.$element,this),this.$manager.undelegate(this.$relatedElement,this),this.$relatedElement.remove();var e="click.colorpicker_"+this.clientId;t(document.body).off(e)}}),a}.apply(e,i),!(void 0!==s&&(t.exports=s))},function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e){t.exports=o},function(t,e){t.exports=i},function(t,e,o){var i;i=function(){return'<div class="colorpicker">\n    <div class="colorpicker-header clearfix">\n        <ul class="clearfix">\n            <% for(var i = 0; i < colors.length; i++) { %>\n            <li value="<%=colors[i]%>" style="background-color:<%=colors[i]%>;" bx-click="pickQuickColor(<%=colors[i]%>)"></li>\n            <% } %>\n        </ul>\n    </div>\n    <div class="colorpicker-middle open clearfix">\n        <i bx-click="toggleBody" class="uxicon arrow arrow-up">&#404</i>\n        <i bx-click="toggleBody" class="uxicon arrow arrow-down">&#405</i>\n    </div>\n    <div class="colorpicker-body clearfix">\n        <div class="picker-wrapper">\n            <div class="picker" bx-click="pickPaletteColor()"></div>\n            <i class="uxicon picker-indicator" bx-mousedown="dragPickerIndicator()">&#470</i>\n        </div>\n        <div class="slide-wrapper">\n            <div class="slide" bx-click="pickSlideColor()"></div>\n            <i class="uxicon slide-indicator" bx-mousedown="dragSlideIndicator">&#461</i>\n        </div>\n    </div>\n    <div class="colorpicker-footer clearfix">\n        <span class="bg" style="background-color: <%=color%>"></span>\n        <input type="text" class="form-control" value="<%=color%>" bx-keyup="inputColor" bx-blur="finishInputColor">\n        <a class="btn btn-default" bx-click="submit">确定</a>\n    </div>\n</div>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))}])});
//# sourceMappingURL=colorpicker.js.map
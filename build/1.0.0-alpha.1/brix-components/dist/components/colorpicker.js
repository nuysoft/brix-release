!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("jquery"),require("underscore"),require("components/base"),require("brix/event")):"function"==typeof define&&define.amd?define(["jquery","underscore","components/base","brix/event"],e):"object"==typeof exports?exports["components/colorpicker"]=e(require("jquery"),require("underscore"),require("components/base"),require("brix/event")):t["components/colorpicker"]=e(t.jquery,t.underscore,t["components/base"],t["brix/event"])}(this,function(t,e,o,i){return function(t){function e(i){if(o[i])return o[i].exports;var s=o[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,e),s.loaded=!0,s.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){var i,s;i=[o(2),o(3),o(4),o(5),o(6)],s=function(t,e,o,i,s,r,n,c,a){function l(){}function d(t,e,o){var i,s,r,n,c;t=t%360/60,c=o*e,n=c*(1-Math.abs(t%2-1)),i=s=r=o-c,t=~~t,i+=[c,n,0,0,n,c][t],s+=[n,c,c,n,0,0][t],r+=[0,0,n,c,c,n][t];var a=255*i,l=255*s,d=255*r;return{r:a,g:l,b:d,hex:"#"+(16777216|d|l<<8|a<<16).toString(16).slice(1)}}function p(t,e,o){(t>1||e>1||o>1)&&(t/=255,e/=255,o/=255);var i,s,r,n;return r=Math.max(t,e,o),n=r-Math.min(t,e,o),i=0===n?null:r==t?(e-o)/n+(e<o?6:0):r==e?(o-t)/n+2:(t-e)/n+4,i=i%6*60,s=0===n?0:n/r,{h:i,s:s,v:r}}return r='\t            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\t                <defs>\t                    <linearGradient id="gradient-hsv" x1="0%" y1="100%" x2="0%" y2="0%">\t                        <stop offset="0%" stop-color="#FF0000" stop-opacity="1"></stop>\t                        <stop offset="13%" stop-color="#FF00FF" stop-opacity="1"></stop>\t                        <stop offset="25%" stop-color="#8000FF" stop-opacity="1"></stop>\t                        <stop offset="38%" stop-color="#0040FF" stop-opacity="1"></stop>\t                        <stop offset="50%" stop-color="#00FFFF" stop-opacity="1"></stop>\t                        <stop offset="63%" stop-color="#00FF40" stop-opacity="1"></stop>\t                        <stop offset="75%" stop-color="#0BED00" stop-opacity="1"></stop>\t                        <stop offset="88%" stop-color="#FFFF00" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#FF0000" stop-opacity="1"></stop>\t                    </linearGradient>\t                </defs>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-hsv)"></rect>\t            </svg>\t        ',n='\t            <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="100%" height="100%">\t                <defs>\t                    <lineargradient id="gradient-black" x1="0%" y1="100%" x2="0%" y2="0%">\t                        <stop offset="0%" stop-color="#000000" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\t                    </lineargradient>\t                    <lineargradient id="gradient-white" x1="0%" y1="100%" x2="100%" y2="100%">\t                        <stop offset="0%" stop-color="#FFFFFF" stop-opacity="1"></stop>\t                        <stop offset="100%" stop-color="#CC9A81" stop-opacity="0"></stop>\t                    </lineargradient>\t                </defs>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-white)"></rect>\t                <rect x="0" y="0" width="100%" height="100%" fill="url(#gradient-black)"></rect>\t            </svg>\t        ',c='\t            <div style="position: relative; width: 100%; height: 100%">\t                <v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>\t                </v:rect>\t            </div>\t        ',a='\t            <div style="position: relative; width: 100%; height: 100%">\t                <v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>\t                </v:rect>\t                <v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">\t                    <v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>\t                </v:rect>\t            </div>\t        ',e.extend(l.prototype,o.prototype,{options:{color:"#ffffff"},init:function(){},render:function(){var o=this;this.$manager=new i("bx-"),this.color=this.options.color;var l=e.template(s)({colors:["#d81e06","#f4ea2a","#1afa29","#1296db","#13227a","#d4237a","#ffffff","#e6e6e6","#dbdbdb","#cdcdcd","#bfbfbf","#8a8a8a","#707070","#515151","#2c2c2c","#000000","#ea986c","#eeb174","#f3ca7e","#f9f28b","#c8db8c","#aad08f","#87c38f","#83c6c2","#7dc5eb","#87a7d6","#8992c8","#a686ba","#bd8cbb","#be8dbd","#e89abe","#e8989a","#e16632","#e98f36","#efb336","#f6ef37","#afcd51","#7cba59","#36ab60","#1baba8","#17ace3","#3f81c1","#4f68b0","#594d9c","#82529d","#a4579d","#db649b","#dd6572","#d81e06","#e0620d","#ea9518","#f4ea2a","#8cbb1a","#2ba515","#0e932e","#0c9890","#1295db","#0061b2","#0061b0","#004198","#122179","#88147f","#d3227b","#d6204b"],min:!1,color:this.color}),d=t(this.element),p=t(l).css({left:d.offset().left,top:d.offset().top+d.outerHeight()+1}).insertAfter(this.element).hide();this.relatedElement=p[0],this.pickerDragNode=p.find(".picker-indicator"),this.slideDragNode=p.find(".slide-indicator");var f=this.slideNode=p.find(".slide"),h=this.pickerNode=p.find(".picker"),u=window.SVGAngle||document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";switch(u){case"SVG":f.append(r),h.append(n);break;default:document.namespaces.v||document.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),f.html(c),h.html(a)}this.setHex(this.color);var v="click.colorpicker_"+this.clientId;t(document.body).off(v).on(v,function(t){o.element!==t.target&&(p.has(t.target).length||o.hide())}),this.$manager.delegate(this.element,this),this.$manager.delegate(this.relatedElement,this)},show:function(){t(this.relatedElement).show()},hide:function(){t(this.relatedElement).hide()},toggle:function(){var e=t(this.element);t(this.relatedElement).toggle().offset({left:e.offset().left,top:e.offset().top+e.outerHeight()+1})},setColor:function(e){var o=t(this.relatedElement);this.h=e.h%360,this.s=e.s,this.v=e.v;var i=d(this.h,this.s,this.v);this.slideDragNode.css({top:Math.round(this.h*this.slideNode.height()/360-5)});var s=Math.round(this.s*this.pickerNode.width()-5),r=Math.round((1-this.v)*this.pickerNode.height()-5);this.pickerDragNode.css({left:s,top:r,color:r>98?"#fff":"#000"}),this.pickerNode.css({"background-color":d(this.h,1,1).hex}),o.find(".colorpicker-footer span").css({"background-color":i.hex}),this.color=i.hex,o.find("li").removeClass("selected");var n=o.find("input");n.val()!==i.hex&&n.val(i.hex)},setHsv:function(t){this.setColor(t)},setRgb:function(t){this.setColor(p(t.r,t.g,t.b),t)},setHex:function(t){this.setColor(p(parseInt(t.substr(1,2),16),parseInt(t.substr(3,2),16),parseInt(t.substr(5,2),16)),void 0,t)},pickQuickColor:function(e,o){this.setHex(o),t(e.target).addClass("selected")},pickPaletteColor:function(t){var e=this.pickerNode.offset(),o=t.pageX-e.left,i=t.pageY-e.top,s=this.pickerNode.width(),r=this.pickerNode.height();this.setHsv({h:this.h,s:o/s,v:(r-i)/r})},dragPickerIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.pickerDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.pickerNode.offset(),i=o.pickerNode.width(),s=o.pickerNode.height(),r=t.pageX-e.left,n=t.pageY-e.top;r+5>i?r=i:r<0?r=0:r+=5,n+5>s?n=s:n<0?n=0:n+=5,o.setHsv({h:o.h,s:r/i,v:(s-n)/s})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.pickerDragNode")})},pickSlideColor:function(t){var e=this.slideNode.offset(),o=this.slideNode.height(),i=t.pageY-e.top>=o?o-1:t.pageY-e.top,s=i/o*360;this.setHsv({h:s,s:this.s,v:this.v})},dragSlideIndicator:function(e){var o=this;t(document.documentElement).css("cursor","pointer"),e.preventDefault(),t(document.body).on("mousemove.slideDragNode",function(t){t.pageX-=5,t.pageY-=5;var e=o.slideNode.offset(),i=o.slideNode.height(),s=t.pageY-e.top;s+5>i?s=i-1:s<0?s=0:s+=5,o.setHsv({h:s/o.slideNode.height()*360,s:o.s,v:o.v})}).on("mouseup",function(){t(document.documentElement).css("cursor","auto"),t(document.body).off("mousemove.slideDragNode")})},inputColor:function(e){var o=t(e.target).val();7===o.length&&this.color!==o&&this.setHex(o)},finishInputColor:function(e){var o=t(e.target).val();this.color!=o&&this.setHex(o)},submit:function(){var e=d(this.h,this.s,this.v),o={hex:e.hex,hsv:{h:this.h,s:this.s,v:this.v},rgb:{r:e.r,g:e.g,b:e.b}};this.trigger("change.colorpicker",o),t(this.element).triggerHandler("change"),this.hide()},destroy:function(){this.$manager.undelegate(this.element,this),this.$manager.undelegate(this.relatedElement,this),this.relatedElement.remove();var e="click.colorpicker_"+this.clientId;t(document.body).off(e)}}),l}.apply(e,i),!(void 0!==s&&(t.exports=s))},function(e,o){e.exports=t},function(t,o){t.exports=e},function(t,e){t.exports=o},function(t,e){t.exports=i},function(t,e,o){var i;i=function(){return'<div class="colorpicker">\n    <div class="colorpicker-header clearfix">\n        <ul>\n            <% for(var i = 0; i < colors.length; i++) { %>\n            <li value="<%=colors[i]%>" style="background-color:<%=colors[i]%>;" bx-click="pickQuickColor(<%=colors[i]%>)"></li>\n            <% } %>\n        </ul>\n    </div>\n    <div class="colorpicker-middle clearfix">\n        <i class="uxicon arrow <%= min ? \'\' : \'arrow-up\' %>">\n            <%= min ? \'&#405\' : \'&#404\' %>\n        </i>\n    </div>\n    <div class="colorpicker-body clearfix <%= min ? \'colorpicker-body-min\' : \'\' %>">\n        <div class="picker-wrapper">\n            <div class="picker" bx-click="pickPaletteColor()"></div>\n            <i class="uxicon picker-indicator" bx-mousedown="dragPickerIndicator()">&#470</i>\n        </div>\n        <div class="slide-wrapper">\n            <div class="slide" bx-click="pickSlideColor()"></div>\n            <i class="uxicon slide-indicator" bx-mousedown="dragSlideIndicator">&#461</i>\n        </div>\n    </div>\n    <div class="colorpicker-footer clearfix">\n        <span class="bg" style="background-color: <%=color%>"></span>\n        <input type="text" class="form-control" value="<%=color%>" bx-keyup="inputColor" bx-blur="finishInputColor">\n        <a class="btn btn-default" bx-click="submit">确定</a>\n    </div>\n</div>'}.call(e,o,e,t),!(void 0!==i&&(t.exports=i))}])});
//# sourceMappingURL=colorpicker.js.map
define(["jquery","underscore","brix/base","brix/event","./modal.tpl.js"],function(e,t,n,i,d){var a=150;return n.extend({options:{title:Math.random(),body:Math.random()},init:function(){this.$element=e(this.element)},render:function(){var n=this;this.$manager=new i("bx-");var a=t.template(d)(this.options);this.$relatedElement=e(a).insertAfter(this.$element),this.$dialog=this.$relatedElement.find(".modal-dialog"),this.$backdropElement=e(".modal-backdrop"),this.$backdropElement.length||(this.$backdropElement=e('<div class="modal-backdrop fade"></div>').hide().appendTo(document.body)),this.$manager.delegate(this.$element,this),this.$manager.delegate(this.$relatedElement,this),this.$element.on("click",function(){n.show()});var o="keyup.modal_"+this.clientId;e(document.body).off(o).on(o,function(e){27===e.which&&n.hide()})},show:function(){e(document.body).addClass("modal-open");var t=this;this.$relatedElement.show(),this.$backdropElement.show(),setTimeout(function(){t.$relatedElement.addClass("in"),t.$backdropElement.addClass("in")},a)},hide:function(){e(document.body).removeClass("modal-open");var t=this;this.$relatedElement.removeClass("in"),this.$backdropElement.removeClass("in"),setTimeout(function(){t.$relatedElement.hide(),t.$backdropElement.hide()},a)},destroy:function(){this.$manager.undelegate(this.$element),this.$manager.undelegate(this.$relatedElement);var t="keyup.modal_"+this.clientId;e(document.body).off(t)}})});